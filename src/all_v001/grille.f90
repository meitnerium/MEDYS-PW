Module grille

use Basics
use math

contains

!****************************************************************************************
!****************************************************************************************
Function EX(EE,theta,phy)
!****************************************************************************************
!****************************************************************************************

Use Basics
Implicit None
real(kind=real_8) :: EX
real(kind=real_8), intent(in):: EE,theta,phy
EX = EE*dsin(theta)*dcos(phy)
return
End Function
!****************************************************************************************
!****************************************************************************************

!****************************************************************************************
!****************************************************************************************
Function EY(EE,theta,phy)
!****************************************************************************************
!****************************************************************************************

Use Basics
Implicit None
real(kind=real_8) :: EY
real(kind=real_8), intent(in):: EE,theta,phy
EY = EE*dsin(theta)*dsin(phy)

End Function
!****************************************************************************************
!****************************************************************************************

!****************************************************************************************
!****************************************************************************************
Function EZ(EE,theta)
!****************************************************************************************
!****************************************************************************************

Use Basics
Implicit None
real(kind=real_8) :: EZ
real(kind=real_8), intent(in):: EE,theta
EZ = EE*dcos(theta)

End Function
!****************************************************************************************
!****************************************************************************************

!****************************************************************************************
!****************************************************************************************
Function zn(N,nx,ny)
!****************************************************************************************
!****************************************************************************************

Use basics
Implicit None
Integer(kind=int_4) :: zn
Integer(kind=int_4), intent(in) :: nx,ny,N


zn=1+int((N-1)/(ny*nx))

End Function

!****************************************************************************************
!****************************************************************************************
Function yn(N,nx,ny)
!****************************************************************************************
!****************************************************************************************

Use basics
Implicit None
Integer(kind=int_4) :: yn
Integer(kind=int_4), intent(in) :: nx,ny,N
Integer(kind=int_4) :: z

z=1+int((N-1)/(ny*nx))

yn=1+int((N-(z-1)*nx*ny-1)/nx)

End Function

!****************************************************************************************
!****************************************************************************************
Function xn(N,nx,ny)
!****************************************************************************************
!****************************************************************************************

Use basics
Implicit None
Integer(kind=int_4) :: xn
Integer(kind=int_4), intent(in) :: nx,ny,N
Integer(kind=int_4) :: z,y

z=1+int((N-1)/(ny*nx))

y=1+int((N-(z-1)*nx*ny-1)/nx)

xn=N-(z-1)*nx*ny-(y-1)*nx

End Function

end module grille
